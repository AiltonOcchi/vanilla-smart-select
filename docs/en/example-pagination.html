<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Pagination in Vanilla Smart Select - Automatic infinite scroll">
  <title>Pagination - Vanilla Smart Select</title>
  <link rel="stylesheet" href="../css/docs.css">
  <link rel="stylesheet" href="../css/vanilla-smart-select.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
</head>
<body>
  <div class="docs-container">
    <aside class="docs-sidebar">
      <div class="sidebar-header">
        <a href="index.html" class="sidebar-logo">
          <div class="sidebar-logo-icon">VS</div>
          <div class="sidebar-logo-text">
            <div class="sidebar-logo-title">Vanilla Smart Select</div>
            <div class="sidebar-logo-subtitle">v1.0.1</div>
          </div>
        </a>
      </div>

      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Introduction</div>
          <ul class="nav-links">
            <li><a href="index.html" class="nav-link">Home</a></li>
            <li><a href="getting-started.html" class="nav-link">Getting Started</a></li>
          </ul>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Resources</div>
          <ul class="nav-links">
            <li><a href="api-reference.html" class="nav-link">API Reference</a></li>
            <li><a href="configuration.html" class="nav-link">Configuration</a></li>
            <li><a href="events.html" class="nav-link">Events</a></li>
          </ul>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Examples</div>
          <ul class="nav-links">
            <li><a href="example-basic.html" class="nav-link">Basic</a></li>
            <li><a href="example-api-programmatic.html" class="nav-link">Programmatic API</a></li>
            <li><a href="example-ajax-basic.html" class="nav-link">Basic AJAX</a></li>
            <li><a href="example-tags.html" class="nav-link">Tags</a></li>
            <li><a href="example-pagination.html" class="nav-link active">Pagination</a></li>
            <li><a href="example-max-selection.html" class="nav-link">Selection Limit</a></li>
            <li><a href="example-validation.html" class="nav-link">Advanced Validation</a></li>
            <li><a href="example-templates.html" class="nav-link">Templates</a></li>
            <li><a href="example-i18n.html" class="nav-link">i18n</a></li>
            <li><a href="example-bootstrap.html" class="nav-link">Bootstrap</a></li>
          </ul>
        </div>
      </nav>
    </aside>

    <main class="docs-main">
      <header class="docs-topbar">
        <button class="mobile-menu-toggle" aria-label="Toggle menu">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
        </button>
        <h1 class="topbar-title">Pagination</h1>
        <div class="topbar-actions">
          <div class="language-switcher">
            <a href="../pt/example-pagination.html" class="lang-link">üáßüá∑ PT</a>
            <span class="lang-separator">|</span>
            <a href="example-pagination.html" class="lang-link active">üá∫üá∏ EN</a>
          </div>
          <a href="https://github.com/ailtonocchi/vanilla-smart-select" class="topbar-btn" target="_blank" rel="noopener noreferrer">
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
              <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
            </svg>
            GitHub
          </a>
        </div>
      </header>

      <div class="docs-content">
        <section class="section-mb-lg">
          <p class="lead">
            Automatic infinite scroll to progressively load large datasets.
            When you scroll the results list to the end, Vanilla Smart Select automatically detects and loads the next page.             
          </p>
        </section>        

        <!-- Example 1: GitHub Repositories -->
        <section class="section-mb-lg">
          <h2>GitHub Repositories - Infinite Scroll</h2>
          <p>Search GitHub repositories with automatic infinite scroll. Scroll to the bottom to load more results.</p>

          <div class="demo-container">
            <label for="github-repos" class="demo-label">Search repositories:</label>
            <select id="github-repos" class="demo-select"></select>

            <div id="repo-result" class="code-details" style="display: none; margin-top: 15px;">
              <strong>Selected Repository:</strong>
              <pre id="repo-data" style="margin-top: 10px; background: #2d2d2d; padding: 10px; border-radius: 4px; overflow-x: auto; color: #ccc; font-size: 0.75rem;"></pre>
            </div>

            <details class="code-details">
              <summary>View code</summary>
              
              <h3>HTML</h3>
              <pre><code class="language-html">&lt;select id="github-repos"&gt;&lt;/select&gt;</code></pre>

              <h3>JavaScript</h3>
              <pre><code class="language-javascript">const reposSelect = new VanillaSmartSelect('#github-repos', {
  placeholder: 'Type to search repositories...',
  allowClear: true,
  ajax: {
    url: 'https://api.github.com/search/repositories',
    delay: 400,
    data: (params) => ({
      q: params.term || 'javascript',
      page: params.page || 1,
      per_page: 10
    }),
    processResults: (data, params) => {
      const results = data.items.map(repo => ({
        id: repo.id,
        text: repo.full_name,
        name: repo.name,
        full_name: repo.full_name,
        description: repo.description || 'No description',
        stars: repo.stargazers_count,
        forks: repo.forks_count,
        language: repo.language || 'Unknown',
        url: repo.html_url
      }));

      return {
        results: results,
        pagination: {
          more: data.items.length >= 10
        }
      };
    }
  },
  templateResult: (item) => {
    const div = document.createElement('div');
    div.innerHTML = `
      &lt;div style="display: flex; gap: 12px;"&gt;
        &lt;div&gt;üì¶&lt;/div&gt;
        &lt;div&gt;
          &lt;div style="font-weight: 500;"&gt;${item.full_name}&lt;/div&gt;
          &lt;div style="font-size: 12px; color: #666;"&gt;${item.description}&lt;/div&gt;
          &lt;div style="font-size: 11px; color: #888; margin-top: 4px;"&gt;
            ‚≠ê ${item.stars.toLocaleString()} | üç¥ ${item.forks.toLocaleString()} | üíª ${item.language}
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    `;
    return div;
  },
  templateSelection: (item) => {
    return `üì¶ ${item.full_name}`;
  }
});</code></pre>
            </details>
          </div>

        </section>

        <!-- Example 2: GitHub Users -->
        <section class="section-mb-lg">
          <h2>GitHub Users - Infinite Scroll</h2>
          <p>Search GitHub users with automatic pagination.</p>

          <div class="demo-container">
            <label for="github-users" class="demo-label">Search users:</label>
            <select id="github-users" class="demo-select"></select>

            <div id="user-result" class="code-details" style="display: none; margin-top: 15px;">
              <strong>Selected User:</strong>
              <pre id="user-data" style="margin-top: 10px; background: #2d2d2d; padding: 10px; border-radius: 4px; overflow-x: auto; color: #ccc; font-size: 0.75rem;"></pre>
            </div>

            <details class="code-details">
              <summary>View code</summary>
              
              <h3>HTML</h3>
              <pre><code class="language-html">&lt;select id="github-users"&gt;&lt;/select&gt;</code></pre>

              <h3>JavaScript</h3>
              <pre><code class="language-javascript">const usersSelect = new VanillaSmartSelect('#github-users', {
  placeholder: 'Type to search users...',
  allowClear: true,
  ajax: {
    url: 'https://api.github.com/search/users',
    delay: 400,
    data: (params) => ({
      q: params.term || 'john',
      page: params.page || 1,
      per_page: 15
    }),
    processResults: (data) => {
      const results = data.items.map(user => ({
        id: user.id,
        text: user.login,
        login: user.login,
        avatar: user.avatar_url,
        url: user.html_url,
        type: user.type
      }));

      return {
        results: results,
        pagination: {
          more: data.items.length >= 15
        }
      };
    }
  },
  templateResult: (item) => {
    const div = document.createElement('div');
    div.style.display = 'flex';
    div.style.alignItems = 'center';
    div.style.gap = '10px';
    div.innerHTML = `
      &lt;img src="${item.avatar}" style="width: 32px; height: 32px; border-radius: 50%;" /&gt;
      &lt;div&gt;
        &lt;div style="font-weight: 500;"&gt;${item.login}&lt;/div&gt;
        &lt;div style="font-size: 11px; color: #666;"&gt;${item.type}&lt;/div&gt;
      &lt;/div&gt;
    `;
    return div;
  },
  templateSelection: (item) => {
    return item.login;
  }
});</code></pre>
            </details>
          </div>

        </section>

        <!-- Example 3: Simulated API -->
        <section class="section-mb-lg">
          <h2>Simulated Paginated API</h2>
          <p>Simulated example with local data to demonstrate the pagination concept (100 items).</p>

          <div class="demo-container">
            <label for="simulated" class="demo-label">Search items:</label>
            <select id="simulated" class="demo-select"></select>

            <div id="simulated-result" class="code-details" style="display: none; margin-top: 15px;">
              <strong>Selected Item:</strong>
              <pre id="simulated-data" style="margin-top: 10px; background: #2d2d2d; padding: 10px; border-radius: 4px; overflow-x: auto; color: #ccc; font-size: 0.75rem;"></pre>
            </div>

            <details class="code-details">
              <summary>View code</summary>
              
              <h3>HTML</h3>
              <pre><code class="language-html">&lt;select id="simulated"&gt;&lt;/select&gt;</code></pre>

              <h3>JavaScript</h3>
              <pre><code class="language-javascript">// Generate 100 example items
const allItems = Array.from({ length: 100 }, (_, i) => ({
  id: i + 1,
  text: `Item ${i + 1}`,
  category: ['Electronics', 'Books', 'Clothing', 'Food'][i % 4],
  price: (Math.random() * 1000).toFixed(2)
}));

const simulatedSelect = new VanillaSmartSelect('#simulated', {
  placeholder: 'Search items (simulated)...',
  allowClear: true,
  ajax: {
    url: '', // N√£o usado
    delay: 300,
    transport: (params) => {
      // Simulate API delay
      return new Promise((resolve) => {
        setTimeout(() => {
          const term = (params.term || '').toLowerCase();
          const page = params.page || 1;
          const perPage = 10;

          // Filter by search term
          let filtered = allItems.filter(item =>
            item.text.toLowerCase().includes(term) ||
            item.category.toLowerCase().includes(term)
          );

          // Paginate
          const start = (page - 1) * perPage;
          const end = start + perPage;
          const pageItems = filtered.slice(start, end);

          resolve({
            items: pageItems,
            total: filtered.length
          });
        }, 500);
      });
    },
    processResults: (data, params) => {
      const page = params.page || 1;
      const perPage = 10;
      const hasMore = (page * perPage) < data.total;

      return {
        results: data.items,
        pagination: { more: hasMore }
      };
    }
  },
  templateResult: (item) => {
    const div = document.createElement('div');
    div.innerHTML = `
      &lt;div style="display: flex; justify-content: space-between;"&gt;
        &lt;div&gt;
          &lt;div style="font-weight: 500;"&gt;${item.text}&lt;/div&gt;
          &lt;div style="font-size: 11px; color: #666;"&gt;${item.category}&lt;/div&gt;
        &lt;/div&gt;
        &lt;div style="color: #007bff; font-weight: 600;"&gt;$${item.price}&lt;/div&gt;
      &lt;/div&gt;
    `;
    return div;
  },
  templateSelection: (item) => {
    return `${item.text} - $${item.price}`;
  }
});</code></pre>
            </details>
          </div>

        </section>

        <!-- Configuration Section -->
        <section class="section-mb-lg">
          <h2>Pagination Configuration</h2>
          
          <h3>processResults Structure</h3>
          <p>To enable pagination, <code>processResults</code> must return an object with the <code>pagination</code> property:</p>

          <pre><code class="language-javascript">processResults: (data, params) => {
  return {
    results: [...],  // Results array
    pagination: {
      more: true     // true if there are more pages
    }
  };
}</code></pre>

          <h3>Automatic Parameters</h3>
          <p>Vanilla Smart Select automatically passes the page number in <code>params.page</code>:</p>

          <pre><code class="language-javascript">data: (params) => ({
  q: params.term,
  page: params.page || 1,  // Current page
  per_page: 10
})</code></pre>

          <h3>Pagination Events</h3>
          <div class="table-responsive">
            <table>
              <thead>
                <tr>
                  <th>Event</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><code>vs:ajaxLoading</code></td>
                  <td>Fired when a page is being loaded</td>
                </tr>
                <tr>
                  <td><code>vs:ajaxSuccess</code></td>
                  <td>Fired when the page is successfully loaded</td>
                </tr>
                <tr>
                  <td><code>vs:ajaxError</code></td>
                  <td>Fired if there is an error loading</td>
                </tr>
              </tbody>
            </table>
          </div>

          <pre><code class="language-javascript">select.addEventListener('vs:ajaxLoading', (e) => {
  console.log('Loading page:', e.detail.params.page);
});

select.addEventListener('vs:ajaxSuccess', (e) => {
  console.log('Loaded', e.detail.results.results.length, 'items');
  console.log('Has more?', e.detail.results.pagination.more);
});</code></pre>
        </section>

        <div class="info-callout info-callout-success">
            <div class="info-callout-title">‚úÖ Usage Tips</div>
            <ul>
              <li>Use <code>per_page</code> between 10-20 for better performance</li>
              <li>Infinite scroll is automatic - no additional code needed</li>
              <li>Results are accumulated automatically</li>
              <li>Works perfectly with search - each term resets pagination</li>
              <li>Combine with custom templates for rich results</li>
        </div>

      </div>
    </main>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
  <script src="../js/vanilla-smart-select.min.js"></script>
  <script src="../js/docs.js"></script>
  <script>
    // Example 1: GitHub Repositories with Infinite Scroll
    const reposSelect = new VanillaSmartSelect('#github-repos', {
      placeholder: 'Digite para buscar reposit√≥rios...',
      allowClear: true,
      ajax: {
        url: 'https://api.github.com/search/repositories',
        delay: 400,
        data: (params) => ({
          q: params.term || 'javascript',
          page: params.page || 1,
          per_page: 10
        }),
        processResults: (data, params) => {
          const results = data.items.map(repo => ({
            id: repo.id,
            text: repo.full_name,
            name: repo.name,
            full_name: repo.full_name,
            description: repo.description || 'No description',
            stars: repo.stargazers_count,
            forks: repo.forks_count,
            language: repo.language || 'Unknown',
            url: repo.html_url
          }));

          return {
            results: results,
            pagination: {
              more: data.items.length >= 10
            }
          };
        }
      },
      templateResult: (item) => {
        const div = document.createElement('div');
        div.style.display = 'flex';
        div.style.gap = '12px';
        div.innerHTML = `
          <div>üì¶</div>
          <div>
            <div style="font-weight: 500;">${item.full_name}</div>
            <div style="font-size: 12px; color: #666;">${item.description}</div>
            <div style="font-size: 11px; color: #888; margin-top: 4px;">
              ‚≠ê ${item.stars.toLocaleString()} | üç¥ ${item.forks.toLocaleString()} | üíª ${item.language}
            </div>
          </div>
        `;
        return div;
      },
      templateSelection: (item) => {
        return `üì¶ ${item.full_name}`;
      }
    });

    document.getElementById('github-repos').addEventListener('vs:select', (e) => {
      const resultDiv = document.getElementById('repo-result');
      const dataDiv = document.getElementById('repo-data');
      resultDiv.style.display = 'block';
      dataDiv.textContent = JSON.stringify(e.detail.data, null, 2);
    });

    // Example 2: GitHub Users with Infinite Scroll
    const usersSelect = new VanillaSmartSelect('#github-users', {
      placeholder: 'Digite para buscar usu√°rios...',
      allowClear: true,
      ajax: {
        url: 'https://api.github.com/search/users',
        delay: 400,
        data: (params) => ({
          q: params.term || 'john',
          page: params.page || 1,
          per_page: 15
        }),
        processResults: (data) => {
          const results = data.items.map(user => ({
            id: user.id,
            text: user.login,
            login: user.login,
            avatar: user.avatar_url,
            url: user.html_url,
            type: user.type
          }));

          return {
            results: results,
            pagination: {
              more: data.items.length >= 15
            }
          };
        }
      },
      templateResult: (item) => {
        const div = document.createElement('div');
        div.style.display = 'flex';
        div.style.alignItems = 'center';
        div.style.gap = '10px';
        div.innerHTML = `
          <img src="${item.avatar}" style="width: 32px; height: 32px; border-radius: 50%;" />
          <div>
            <div style="font-weight: 500;">${item.login}</div>
            <div style="font-size: 11px; color: #666;">${item.type}</div>
          </div>
        `;
        return div;
      },
      templateSelection: (item) => {
        return item.login;
      }
    });

    document.getElementById('github-users').addEventListener('vs:select', (e) => {
      const resultDiv = document.getElementById('user-result');
      const dataDiv = document.getElementById('user-data');
      resultDiv.style.display = 'block';
      dataDiv.textContent = JSON.stringify(e.detail.data, null, 2);
    });

    // Example 3: Simulated Paginated API
    const allItems = Array.from({ length: 100 }, (_, i) => ({
      id: i + 1,
      text: `Item ${i + 1}`,
      category: ['Electronics', 'Books', 'Clothing', 'Food'][i % 4],
      price: (Math.random() * 1000).toFixed(2)
    }));

    const simulatedSelect = new VanillaSmartSelect('#simulated', {
      placeholder: 'Buscar items (simulado)...',
      allowClear: true,
      ajax: {
        url: '',
        delay: 300,
        transport: (params) => {
          return new Promise((resolve) => {
            setTimeout(() => {
              const term = (params.term || '').toLowerCase();
              const page = params.page || 1;
              const perPage = 10;

              let filtered = allItems.filter(item =>
                item.text.toLowerCase().includes(term) ||
                item.category.toLowerCase().includes(term)
              );

              const start = (page - 1) * perPage;
              const end = start + perPage;
              const pageItems = filtered.slice(start, end);

              resolve({
                items: pageItems,
                total: filtered.length
              });
            }, 500);
          });
        },
        processResults: (data, params) => {
          const page = params.page || 1;
          const perPage = 10;
          const hasMore = (page * perPage) < data.total;

          return {
            results: data.items,
            pagination: { more: hasMore }
          };
        }
      },
      templateResult: (item) => {
        const div = document.createElement('div');
        div.style.display = 'flex';
        div.style.justifyContent = 'space-between';
        div.innerHTML = `
          <div>
            <div style="font-weight: 500;">${item.text}</div>
            <div style="font-size: 11px; color: #666;">${item.category}</div>
          </div>
          <div style="color: #007bff; font-weight: 600;">$${item.price}</div>
        `;
        return div;
      },
      templateSelection: (item) => {
        return `${item.text} - $${item.price}`;
      }
    });

    document.getElementById('simulated').addEventListener('vs:select', (e) => {
      const resultDiv = document.getElementById('simulated-result');
      const dataDiv = document.getElementById('simulated-data');
      resultDiv.style.display = 'block';
      dataDiv.textContent = JSON.stringify(e.detail.data, null, 2);
    });

    // Log events
    document.querySelectorAll('select').forEach(select => {
      select.addEventListener('vs:ajaxLoading', (e) => {
        console.log('üîÑ Loading page:', e.detail.params.page);
      });

      select.addEventListener('vs:ajaxSuccess', (e) => {
        console.log('‚úÖ Loaded', e.detail.results.results.length, 'items. Has more:', e.detail.results.pagination.more);
      });
    });
  </script>
</body>
</html>
