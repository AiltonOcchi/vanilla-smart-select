<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pagination / Infinite Scroll + Bootstrap 5 - Vanilla Smart Select</title>

  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Vanilla Smart Select CSS -->
  <link rel="stylesheet" href="../dist/vanilla-smart-select.css">

  <style>
    /* Custom styles for GitHub repos */
    .repo-option {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 4px 0;
    }

    .repo-icon {
      font-size: 24px;
      flex-shrink: 0;
      margin-top: 2px;
    }

    .repo-info {
      flex: 1;
      min-width: 0;
    }

    .repo-name {
      font-weight: 500;
      color: #333;
      margin-bottom: 4px;
    }

    .repo-description {
      font-size: 12px;
      color: #666;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .repo-stats {
      display: flex;
      gap: 12px;
      margin-top: 6px;
      font-size: 11px;
      color: #888;
    }

    .repo-stat {
      display: flex;
      align-items: center;
      gap: 4px;
    }
  </style>
</head>
<body>
  <div class="container py-5">
    <h1 class="mb-4">üìú Pagination / Infinite Scroll</h1>

    <div class="alert alert-info mb-4" role="alert">
      <strong>üí° Como funciona:</strong> Role a lista de resultados at√© o final para carregar automaticamente a pr√≥xima p√°gina. A pagina√ß√£o √© transparente e os resultados s√£o acumulados.
    </div>

    <!-- Exemplo 1: GitHub Repositories -->
    <div class="card mb-4">
      <div class="card-body">
        <h2 class="card-title h5">1. üì¶ GitHub Repositories - Infinite Scroll</h2>
        <p class="text-muted">Busque reposit√≥rios do GitHub. Role at√© o final para carregar mais resultados automaticamente.</p>
        <p><strong>Dica:</strong> Digite "javascript", "react", "vue", etc.</p>

        <div class="mb-3">
          <label for="github-repos" class="form-label">Buscar reposit√≥rios:</label>
          <select id="github-repos" class="form-select"></select>
        </div>

        <div class="alert alert-primary" role="alert">
          <strong>Recursos:</strong>
          <ul class="mb-0 mt-2">
            <li><strong>Infinite Scroll:</strong> Role at√© o final para carregar mais</li>
            <li><strong>API GitHub:</strong> Busca real na API p√∫blica do GitHub</li>
            <li><strong>Templates ricos:</strong> Mostra nome, descri√ß√£o, stars e forks</li>
          </ul>
        </div>

        <div class="card mt-3 d-none" id="repo-result">
          <div class="card-header bg-success text-white">
            <strong>üì¶ Reposit√≥rio Selecionado:</strong>
          </div>
          <div class="card-body">
            <pre class="mb-0" id="repo-data" style="background: #f8f9fa; padding: 15px; border-radius: 4px; max-height: 300px; overflow: auto;"></pre>
          </div>
        </div>
      </div>
    </div>

    <!-- Exemplo 2: GitHub Users -->
    <div class="card mb-4">
      <div class="card-body">
        <h2 class="card-title h5">2. üë§ GitHub Users - Infinite Scroll</h2>
        <p class="text-muted">Busque usu√°rios do GitHub com pagina√ß√£o autom√°tica.</p>
        <p><strong>Dica:</strong> Digite qualquer nome de usu√°rio.</p>

        <div class="mb-3">
          <label for="github-users" class="form-label">Buscar usu√°rios:</label>
          <select id="github-users" class="form-select"></select>
        </div>

        <div class="alert alert-primary" role="alert">
          <strong>Recursos:</strong>
          <ul class="mb-0 mt-2">
            <li><strong>Avatar:</strong> Mostra foto do perfil do usu√°rio</li>
            <li><strong>Infinite Scroll:</strong> Carrega mais ao rolar</li>
            <li><strong>Tipo de conta:</strong> User ou Organization</li>
          </ul>
        </div>

        <div class="card mt-3 d-none" id="user-result">
          <div class="card-header bg-info text-white">
            <strong>üë§ Usu√°rio Selecionado:</strong>
          </div>
          <div class="card-body">
            <pre class="mb-0" id="user-data" style="background: #f8f9fa; padding: 15px; border-radius: 4px;"></pre>
          </div>
        </div>
      </div>
    </div>

    <!-- Exemplo 3: Simula√ß√£o -->
    <div class="card mb-4">
      <div class="card-body">
        <h2 class="card-title h5">3. üé¨ Simula√ß√£o de API Paginada</h2>
        <p class="text-muted">Exemplo simulado com dados locais para demonstrar o conceito de pagina√ß√£o.</p>

        <div class="mb-3">
          <label for="simulated" class="form-label">Buscar items:</label>
          <select id="simulated" class="form-select"></select>
        </div>

        <div class="alert alert-primary" role="alert">
          <strong>Recursos:</strong>
          <ul class="mb-0 mt-2">
            <li><strong>100 items:</strong> Dados simulados localmente</li>
            <li><strong>Pagina√ß√£o:</strong> 10 items por p√°gina</li>
            <li><strong>Busca:</strong> Filtra por nome ou categoria</li>
          </ul>
        </div>

        <div class="card mt-3 d-none" id="simulated-result">
          <div class="card-header bg-primary text-white">
            <strong>üé¨ Item Selecionado:</strong>
          </div>
          <div class="card-body">
            <pre class="mb-0" id="simulated-data" style="background: #f8f9fa; padding: 15px; border-radius: 4px;"></pre>
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- Bootstrap 5 JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Vanilla Smart Select JS -->
  <script src="../dist/vanilla-smart-select.js"></script>

  <script>
    // Exemplo 1: GitHub Repositories with Infinite Scroll
    const reposSelect = new VanillaSmartSelect('#github-repos', {
      placeholder: 'Digite para buscar reposit√≥rios...',
      allowClear: true,
      ajax: {
        url: 'https://api.github.com/search/repositories',
        delay: 400,
        data: (params) => ({
          q: params.term || 'javascript',
          page: params.page || 1,
          per_page: 10
        }),
        processResults: (data, params) => {
          const results = data.items.map(repo => ({
            id: repo.id,
            text: repo.full_name,
            name: repo.name,
            full_name: repo.full_name,
            description: repo.description || 'No description',
            stars: repo.stargazers_count,
            forks: repo.forks_count,
            language: repo.language || 'Unknown',
            url: repo.html_url
          }));

          return {
            results: results,
            pagination: {
              more: data.items.length >= 10
            }
          };
        }
      },
      templateResult: (item) => {
        const div = document.createElement('div');
        div.className = 'repo-option';
        div.innerHTML = `
          <div class="repo-icon">üì¶</div>
          <div class="repo-info">
            <div class="repo-name">${item.full_name}</div>
            <div class="repo-description">${item.description}</div>
            <div class="repo-stats">
              <span class="repo-stat">‚≠ê ${item.stars.toLocaleString()}</span>
              <span class="repo-stat">üç¥ ${item.forks.toLocaleString()}</span>
              <span class="repo-stat">üíª ${item.language}</span>
            </div>
          </div>
        `;
        return div;
      },
      templateSelection: (item) => {
        return `üì¶ ${item.full_name}`;
      }
    });

    document.getElementById('github-repos').addEventListener('vs:select', (e) => {
      document.getElementById('repo-result').classList.remove('d-none');
      document.getElementById('repo-data').textContent = JSON.stringify(e.detail.data, null, 2);
    });

    // Exemplo 2: GitHub Users with Infinite Scroll
    const usersSelect = new VanillaSmartSelect('#github-users', {
      placeholder: 'Digite para buscar usu√°rios...',
      allowClear: true,
      ajax: {
        url: 'https://api.github.com/search/users',
        delay: 400,
        data: (params) => ({
          q: params.term || 'john',
          page: params.page || 1,
          per_page: 15
        }),
        processResults: (data) => {
          const results = data.items.map(user => ({
            id: user.id,
            text: user.login,
            login: user.login,
            avatar: user.avatar_url,
            url: user.html_url,
            type: user.type
          }));

          return {
            results: results,
            pagination: {
              more: data.items.length >= 15
            }
          };
        }
      },
      templateResult: (item) => {
        const div = document.createElement('div');
        div.className = 'd-flex align-items-center gap-2';
        div.innerHTML = `
          <img src="${item.avatar}" class="rounded-circle" style="width: 32px; height: 32px;" />
          <div>
            <div class="fw-bold">${item.login}</div>
            <small class="text-muted">${item.type}</small>
          </div>
        `;
        return div;
      },
      templateSelection: (item) => {
        return item.login;
      }
    });

    document.getElementById('github-users').addEventListener('vs:select', (e) => {
      document.getElementById('user-result').classList.remove('d-none');
      document.getElementById('user-data').textContent = JSON.stringify(e.detail.data, null, 2);
    });

    // Exemplo 3: Simula√ß√£o de API Paginada
    const allItems = Array.from({ length: 100 }, (_, i) => ({
      id: i + 1,
      text: `Item ${i + 1}`,
      category: ['Electronics', 'Books', 'Clothing', 'Food'][i % 4],
      price: (Math.random() * 1000).toFixed(2)
    }));

    const simulatedSelect = new VanillaSmartSelect('#simulated', {
      placeholder: 'Buscar items (simulado)...',
      allowClear: true,
      ajax: {
        url: '',
        delay: 300,
        transport: (params) => {
          return new Promise((resolve) => {
            setTimeout(() => {
              const term = (params.term || '').toLowerCase();
              const page = params.page || 1;
              const perPage = 10;

              let filtered = allItems.filter(item =>
                item.text.toLowerCase().includes(term) ||
                item.category.toLowerCase().includes(term)
              );

              const start = (page - 1) * perPage;
              const end = start + perPage;
              const pageItems = filtered.slice(start, end);

              resolve({
                items: pageItems,
                total: filtered.length
              });
            }, 500);
          });
        },
        processResults: (data, params) => {
          const page = params.page || 1;
          const perPage = 10;
          const hasMore = (page * perPage) < data.total;

          return {
            results: data.items,
            pagination: { more: hasMore }
          };
        }
      },
      templateResult: (item) => {
        const div = document.createElement('div');
        div.className = 'd-flex justify-content-between align-items-center';
        div.innerHTML = `
          <div>
            <div class="fw-bold">${item.text}</div>
            <small class="text-muted">${item.category}</small>
          </div>
          <span class="text-primary fw-bold">$${item.price}</span>
        `;
        return div;
      },
      templateSelection: (item) => {
        return `${item.text} - $${item.price}`;
      }
    });

    document.getElementById('simulated').addEventListener('vs:select', (e) => {
      document.getElementById('simulated-result').classList.remove('d-none');
      document.getElementById('simulated-data').textContent = JSON.stringify(e.detail.data, null, 2);
    });

    // Log eventos
    document.querySelectorAll('select').forEach(select => {
      select.addEventListener('vs:ajaxLoading', (e) => {
        console.log('üîÑ Carregando p√°gina:', e.detail.params.page);
      });

      select.addEventListener('vs:ajaxSuccess', (e) => {
        console.log('‚úÖ Carregados', e.detail.results.results.length, 'items. Tem mais:', e.detail.results.pagination.more);
      });
    });

    console.log('‚úì Exemplo de Pagination inicializado!');
  </script>
</body>
</html>
